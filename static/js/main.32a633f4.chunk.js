(this.webpackJsonpfactorio_calculator=this.webpackJsonpfactorio_calculator||[]).push([[0],{30:function(e,t,a){e.exports=a(43)},35:function(e,t,a){},36:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(16),c=a.n(r),l=(a(35),a(36),a(7)),u=a(12),o=a(14),s=a(19),m=a(18),p=function e(t){Object(u.a)(this,e),this.recipe=void 0,this.count=void 0,this.recipe=t,this.count=1},h=function(){function e(t){Object(u.a)(this,e),this.recipes=[],this.goal=void 0,this.additional_inputs=[],this.additional_outputs=[],this.goal=t}return Object(o.a)(e,[{key:"add",value:function(e){this.recipes.push(new p(e))}},{key:"calculate",value:function(){var e=this;this.additional_inputs=[],this.additional_outputs=[];var t,a=null,n=Object(l.a)(this.recipes);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.recipe.outputs.find((function(t){return t.item===e.goal.item}));if(r){var c=f(i.recipe,r,this.goal);i.count=c,a=i.recipe;var u,o=i.recipe.machine.speed/i.recipe.craft_time*c,s=Object(l.a)(i.recipe.inputs);try{for(s.s();!(u=s.n()).done;){var m=u.value;this.additional_inputs.push({amount:m.amount*o,item:m.item})}}catch(k){s.e(k)}finally{s.f()}var p,h=Object(l.a)(i.recipe.outputs.filter((function(t){return t.item!==e.goal.item})));try{for(h.s();!(p=h.n()).done;){var d=p.value;this.additional_outputs.push({amount:d.amount*o,item:d.item})}}catch(k){h.e(k)}finally{h.f()}}else i.count=0}}catch(k){n.e(k)}finally{n.f()}for(var E=!0,y=0;E&&y<1e3;){y++,E=!1;var g,b=Object(l.a)(this.recipes.filter((function(e){return e.recipe!==a})));try{for(b.s();!(g=b.n()).done;){var O=g.value;E=v(this.additional_inputs,this.additional_outputs,O)||E}}catch(k){b.e(k)}finally{b.f()}this.balanceInputAndOutput()}100===y&&console.error("Could not finish calculating the schematic, update_count reached "+y)}},{key:"hasRecipe",value:function(e){return this.recipes.some((function(t){return t.recipe.name===e.name}))}},{key:"balanceInputAndOutput",value:function(){var e,t=this,a=Object(l.a)(this.additional_inputs);try{for(a.s();!(e=a.n()).done;){var n,i=e.value,r=Object(l.a)(this.additional_outputs);try{for(r.s();!(n=r.n()).done;){var c=n.value;if(i.item===c.item){var u=function(e){var a=t.additional_inputs.findIndex((function(t){return t.item===e.item}));t.additional_inputs.splice(a,1)},o=function(e){var a=t.additional_outputs.findIndex((function(t){return t.item===e.item}));t.additional_outputs.splice(a,1)};i.amount===c.amount?(u(i),o(c)):i.amount>c.amount?(i.amount-=c.amount,o(c)):c.amount>i.amount&&(c.amount-=i.amount,u(i))}}}catch(s){r.e(s)}finally{r.f()}}}catch(s){a.e(s)}finally{a.f()}}}]),e}();function f(e,t,a){var n=e.craft_time/e.machine.speed;return a.amount/t.amount*n}function d(e,t){var a,n=Object(l.a)(e);try{for(n.s();!(a=n.n()).done;){var i=a.value;if(i.item===t.item)return void(i.amount+=t.amount)}}catch(r){n.e(r)}finally{n.f()}e.push(t)}function v(e,t,a){var n,i=Object(l.a)(e);try{var r=function(){var i=n.value,r=a.recipe.outputs.find((function(e){return e.item===i.item}));if(null==r)return"continue";c=f(a.recipe,r,i),a.count+=c,u=e.findIndex((function(e){return e.item===i.item})),e.splice(u,1);var o,s=a.recipe.machine.speed/a.recipe.craft_time*c,m=Object(l.a)(a.recipe.outputs.filter((function(e){return e.item!==i.item})));try{for(m.s();!(o=m.n()).done;){var p=o.value;d(t,{item:p.item,amount:p.amount*s})}}catch(y){m.e(y)}finally{m.f()}var h,v=Object(l.a)(a.recipe.inputs);try{for(v.s();!(h=v.n()).done;){var E=h.value;d(e,{item:E.item,amount:E.amount*s})}}catch(y){v.e(y)}finally{v.f()}return{v:!0}};for(i.s();!(n=i.n()).done;){var c,u,o=r();switch(o){case"continue":continue;default:if("object"===typeof o)return o.v}}}catch(s){i.e(s)}finally{i.f()}return!1}var E=a(22),y=a(13),g=a(11),b=a(17),O=a(24),k=function(e){Object(s.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"renderInputOutput",value:function(e){var t=this.props.recipe,a=t.machine,n=this.props.amountOfMachines,r=t.inputs[e],c=t.outputs[e],l=a.speed/t.craft_time*n;return i.a.createElement("tr",{key:e},i.a.createElement("td",null,r?r.item:""),i.a.createElement("td",null,r?(r.amount*l).toFixed(2):""),i.a.createElement("td",null,c?c.item:""),i.a.createElement("td",null,c?(c.amount*l).toFixed(2):""))}},{key:"render",value:function(){var e=this,t=this.props.recipe,a=t.inputs.length>t.outputs.length?t.inputs.length:t.outputs.length;return i.a.createElement(y.a,null,i.a.createElement(y.a.Header,null,i.a.createElement("h3",null,t.name),i.a.createElement("span",{style:{float:"right"}},i.a.createElement("b",null,this.props.amountOfMachines.toFixed(1),"x")," ",t.machine.name)),i.a.createElement(E.a,{striped:!0,bordered:!0,hover:!0,size:"sm"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Input"),i.a.createElement("th",null),i.a.createElement("th",null,"Output"),i.a.createElement("th",null))),i.a.createElement("tbody",null,Array(a).fill(0).map((function(t,a){return e.renderInputOutput(a)})))),i.a.createElement(y.a.Footer,null,i.a.createElement(g.a,{variant:"outline-secondary",disabled:!this.props.canMoveUp,onClick:this.props.onMoveUp},i.a.createElement(O.b,null))," ",i.a.createElement(g.a,{variant:"outline-secondary",disabled:!this.props.canMoveDown,onClick:this.props.onMoveDown},i.a.createElement(O.a,null)),i.a.createElement(g.a,{variant:"danger",style:{float:"right"},onClick:this.props.onDelete},i.a.createElement(b.d,null))))}}]),a}(i.a.Component),_=a(29),C=a(15),j=a(9),S=new(function(){function e(){Object(u.a)(this,e),this.recipes=void 0,this.machines=[{name:"Strand casting machine 4",speed:3},{name:"Blast furnace 4",speed:3},{name:"Induction furnace 4",speed:3},{name:"Pellet press 4",speed:3},{name:"Ore processing machine",speed:3},{name:"Ore sorting facility",speed:2},{name:"Ore refinery",speed:1.5},{name:"Leaching plant",speed:1.5},{name:"Crafting machine",speed:2.75},{name:"Filtration unit",speed:2.25},{name:"Crystallizer",speed:2.25},{name:"Hydro plant",speed:2},{name:"Electrolyser",speed:2.5},{name:"Ore crusher",speed:3},{name:"Washing plant",speed:2.25},{name:"Liquifier",speed:3.75},{name:"Algae farm",speed:1.5},{name:"Custom",speed:1}],this.recipes=[];try{var t=localStorage.getItem("recipes");null!=t&&(this.recipes=JSON.parse(t),console.log("Loaded "+this.recipes.length+" recipes"))}catch(a){}}return Object(o.a)(e,[{key:"save",value:function(){localStorage.setItem("recipes",JSON.stringify(this.recipes))}},{key:"allItems",value:function(){var e,t=[],a=Object(l.a)(this.recipes);try{for(a.s();!(e=a.n()).done;){var n,i=e.value,r=Object(l.a)(i.outputs);try{var c=function(){var e=n.value;if(t.some((function(t){return t===e.item})))return"continue";t.push(e.item)};for(r.s();!(n=r.n()).done;)c()}catch(u){r.e(u)}finally{r.f()}}}catch(u){a.e(u)}finally{a.f()}return t.sort(),t}}]),e}()),I=a(20),R=a(10),w=a(28);function M(e){var t,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={name:e.name,craft_time:e.craft_time,machine:{name:e.machine.name,speed:e.machine.speed},inputs:[],outputs:[]},i=Object(l.a)(e.inputs);try{for(i.s();!(t=i.n()).done;){var r=t.value;n.inputs.push({item:r.item,amount:r.amount})}}catch(s){i.e(s)}finally{i.f()}a&&n.inputs.push({item:"",amount:0});var c,u=Object(l.a)(e.outputs);try{for(u.s();!(c=u.n()).done;){var o=c.value;n.outputs.push({item:o.item,amount:o.amount})}}catch(s){u.e(s)}finally{u.f()}return a&&n.outputs.push({item:"",amount:0}),n}var F=function(e){Object(s.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state=a.getDerivedStateFromProps(e,{recipe:null,craft_time:""}),n}return Object(o.a)(a,[{key:"updateName",value:function(e){if(null!==this.state.recipe){var t=M(this.state.recipe);t.name=e,this.setState({recipe:t})}}},{key:"updateMachine",value:function(e){var t=S.machines.find((function(t){return t.name===e}));if(null!==this.state.recipe&&null!==t){var a=M(this.state.recipe);a.machine=t,this.setState({recipe:a})}}},{key:"updateCraftTime",value:function(e){this.setState({craft_time:e})}},{key:"commitCraftTime",value:function(){try{var e=parseFloat(this.state.craft_time);if(!isNaN(e)&&!Object(w.isNullOrUndefined)(e)){if(null===this.state.recipe)return;var t=M(this.state.recipe);return t.craft_time=e,void this.setState({craft_time:e.toString(),recipe:t})}}catch(n){}var a=this.state.recipe?this.state.recipe.craft_time.toString():"0";this.setState({craft_time:a})}},{key:"render",value:function(){var e=this,t=null!==this.state.recipe,a=this.state.recipe||x;return i.a.createElement(I.a,{show:t,onHide:this.props.onCancel,animation:!1},i.a.createElement(I.a.Header,{closeButton:!0},i.a.createElement(I.a.Title,null,"Edit recipe")),i.a.createElement(I.a.Body,null,i.a.createElement(R.a,null,i.a.createElement(R.a.Group,{as:C.a,controlId:"recipe_name"},i.a.createElement(R.a.Label,{column:!0,sm:"2"},"Name"),i.a.createElement(j.a,{sm:"10"},i.a.createElement(R.a.Control,{value:a.name,onChange:function(t){return e.updateName(t.target.value)}}))),i.a.createElement(R.a.Group,{as:C.a,controlId:"machine"},i.a.createElement(R.a.Label,{column:!0,sm:"2"},"Machine"),i.a.createElement(j.a,{sm:"10"},i.a.createElement(R.a.Control,{as:"select",value:a.machine.name,onChange:function(t){return e.updateMachine(t.target.value)}},S.machines.map((function(e){return i.a.createElement("option",{key:e.name},e.name)}))))),i.a.createElement(R.a.Group,{as:C.a,controlId:"craft_time"},i.a.createElement(R.a.Label,{column:!0,sm:"2"},"Craft time"),i.a.createElement(j.a,{sm:"10"},i.a.createElement(R.a.Control,{value:this.state.craft_time,onChange:function(t){return e.updateCraftTime(t.target.value)},onBlur:function(){return e.commitCraftTime()}}))),i.a.createElement("b",null,"Inputs"),this.renderItemList(a.inputs,(function(e,t){return e.inputs=t})),i.a.createElement("b",null,"Outputs"),this.renderItemList(a.outputs,(function(e,t){return e.outputs=t})))),i.a.createElement(I.a.Footer,null,i.a.createElement(g.a,{variant:"danger",onClick:function(){return e.deleteRecipe()}},i.a.createElement(b.e,null)),i.a.createElement(g.a,{variant:"danger",onClick:this.props.onCancel},"Cancel"),i.a.createElement(g.a,{variant:"primary",onClick:function(){var t=e.state.recipe;null!==t&&(t.inputs=t.inputs.filter((function(e){return""!==e.item&&e.amount>0})),t.outputs=t.outputs.filter((function(e){return""!==e.item&&e.amount>0})),e.props.onSave(t))}},"Save")))}},{key:"renderItemList",value:function(e,t){var a=this;return e.map((function(n,r){return i.a.createElement(R.a.Group,{as:C.a,key:r},i.a.createElement(j.a,{sm:"10"},i.a.createElement(R.a.Control,{value:n.item,onChange:function(n){return function(n,i,r){e[i].item=r,i===e.length-1&&e.push({item:"",amount:0});var c=M(a.state.recipe);t(c,e),a.setState({recipe:c})}(0,r,n.target.value)}})),i.a.createElement(j.a,{sm:"2"},i.a.createElement(R.a.Control,{value:n.amount,onChange:function(n){return function(n,i,r){e[i].amount=parseFloat(r)||e[i].amount,i===e.length-1&&e.push({item:"",amount:0});var c=M(a.state.recipe);t(c,e),a.setState({recipe:c})}(0,r,n.target.value)}})))}))}},{key:"deleteRecipe",value:function(){if(null!==this.state.recipe){var e=this.state.recipe,t=S.recipes.findIndex((function(t){return t.name===e.name}));-1!==t&&(S.recipes.splice(t,1),S.save(),this.props.onCancel())}}}],[{key:"getDerivedStateFromProps",value:function(e,t){return null!==e.recipe&&null===t.recipe?{recipe:M(e.recipe,!0),craft_time:e.recipe.craft_time.toString()}:null===e.recipe?{recipe:null,craft_time:"0"}:t}}]),a}(i.a.Component),x={name:"",machine:S.machines[0],inputs:[],outputs:[],craft_time:1},L=function(e){Object(s.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(u.a)(this,a),n=t.call(this,e);var i=new h({item:"Iron sheet coil",amount:45});return i.calculate(),n.state={schematic:i,editRecipe:null},n}return Object(o.a)(a,[{key:"setGoalItem",value:function(e){var t=this.state.schematic;t.goal.item=e,t.calculate(),this.setState({schematic:t})}},{key:"setGoalAmount",value:function(e){var t=this.state.schematic;t.goal.amount=parseFloat(e)||t.goal.amount,t.calculate(),this.setState({schematic:t})}},{key:"render",value:function(){var e=this,t=this.state.schematic,a=S.recipes.filter((function(e){return!t.hasRecipe(e)})),n=a.filter((function(e){var a,n=Object(l.a)(e.outputs);try{for(n.s();!(a=n.n()).done;){var i=a.value;if(i.item===t.goal.item)return!0;var r,c=Object(l.a)(t.additional_inputs);try{for(c.s();!(r=c.n()).done;){var u=r.value;if(i.item===u.item)return!0}}catch(o){c.e(o)}finally{c.f()}}}catch(o){n.e(o)}finally{n.f()}return!1})),r=a.filter((function(e){return n.every((function(t){return t.name!==e.name}))}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.a,{fluid:!0},i.a.createElement(C.a,null,i.a.createElement(j.a,null,i.a.createElement("b",null,"Goal: ")," ",i.a.createElement("input",{type:"text",value:this.state.schematic.goal.amount,size:3,onChange:function(t){return e.setGoalAmount(t.target.value)}})," ",i.a.createElement("select",{value:this.state.schematic.goal.item,onChange:function(t){return e.setGoalItem(t.target.value)}},S.allItems().map((function(e){return i.a.createElement("option",null,e)}))),t.recipes.map((function(a,n){return i.a.createElement(k,{key:n,recipe:a.recipe,amountOfMachines:a.count,canMoveUp:n>0,canMoveDown:n<t.recipes.length-1,onDelete:function(){return e.removeRecipe(a.recipe)},onMoveUp:function(){return e.swapRecipes(n-1,n)},onMoveDown:function(){return e.swapRecipes(n,n+1)}})}))),i.a.createElement(j.a,null,i.a.createElement(C.a,null,i.a.createElement(j.a,null,i.a.createElement("h2",null,"Recipes")),i.a.createElement(g.a,{variant:"outline-primary",onClick:function(){return e.newRecipe()}},i.a.createElement(b.b,null))),this.renderRecipeList("Suggested",n),this.renderRecipeList("Other",r)),i.a.createElement(j.a,null,i.a.createElement(y.a,null,i.a.createElement(y.a.Header,null,"Additional inputs"),A(t.additional_inputs)),i.a.createElement(y.a,null,i.a.createElement(y.a.Header,null,"Additional outputs"),A(t.additional_outputs)),i.a.createElement(y.a,null,i.a.createElement(y.a.Header,null,"Machines required"),this.renderMachineList())))),i.a.createElement(F,{recipe:this.state.editRecipe,onSave:function(t){return e.saveRecipe(t)},onCancel:function(){return e.resetEditRecipe()}}))}},{key:"renderRecipeList",value:function(e,t){var a=this;return 0===t.length?i.a.createElement(i.a.Fragment,null):i.a.createElement(i.a.Fragment,null,i.a.createElement("b",null,e),t.map((function(e,t){return a.renderRecipe(e,t)})))}},{key:"renderMachineList",value:function(){return i.a.createElement(E.a,{size:"sm"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Recipe"),i.a.createElement("th",null,"Machine"),i.a.createElement("th",null,"Amount"))),i.a.createElement("tbody",null,this.state.schematic.recipes.map((function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,e.recipe.name),i.a.createElement("td",null,e.recipe.machine.name),i.a.createElement("td",null,e.count.toFixed(1)))}))))}},{key:"newRecipe",value:function(){this.setState({editRecipe:x})}},{key:"resetEditRecipe",value:function(){this.state.schematic.calculate(),this.setState({editRecipe:null})}},{key:"saveRecipe",value:function(e){var t=S.recipes.findIndex((function(t){return t.name===e.name}));-1!==t?S.recipes[t]=e:S.recipes.push(e),S.save(),this.resetEditRecipe()}},{key:"swapRecipes",value:function(e,t){var a=this.state.schematic;if(e>=0&&t>=0&&e<a.recipes.length&&t<a.recipes.length){var n=a.recipes[e];a.recipes[e]=a.recipes[t],a.recipes[t]=n,this.setState({schematic:a})}}},{key:"removeRecipe",value:function(e){var t=this.state.schematic,a=t.recipes.findIndex((function(t){return t.recipe.name===e.name}));-1!==a&&(t.recipes.splice(a,1),t.calculate(),this.setState({schematic:t}))}},{key:"renderRecipe",value:function(e,t){var a=this;return i.a.createElement(C.a,{key:t},i.a.createElement(g.a,{variant:"outline-primary",as:j.a,onClick:function(t){t.preventDefault();var n=a.state.schematic;n.add(e),n.calculate(),a.setState({schematic:n})}},i.a.createElement(b.c,null)," ",e.name),i.a.createElement(g.a,{variant:"outline-secondary",onClick:function(){a.setState({editRecipe:e})}},i.a.createElement(b.a,null)))}}]),a}(i.a.Component);function A(e){return i.a.createElement(E.a,{size:"sm"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Item"),i.a.createElement("th",null,"Amount"))),i.a.createElement("tbody",null,e.map((function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,e.item),i.a.createElement("td",null,e.amount.toFixed(2)))}))))}var D=function(){return i.a.createElement(L,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.32a633f4.chunk.js.map