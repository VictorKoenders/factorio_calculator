(this.webpackJsonpfactorio_calculator=this.webpackJsonpfactorio_calculator||[]).push([[0],{30:function(e,t,a){e.exports=a(43)},35:function(e,t,a){},36:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(17),c=a.n(i),l=(a(35),a(36),a(7)),u=a(12),o=a(14),s=a(19),m=a(18),p=function e(t){Object(u.a)(this,e),this.recipe=void 0,this.count=void 0,this.recipe=t,this.count=1},h=function(){function e(t){Object(u.a)(this,e),this.recipes=[],this.goal=void 0,this.additional_inputs=[],this.additional_outputs=[],this.goal=t}return Object(o.a)(e,[{key:"add",value:function(e){this.recipes.push(new p(e))}},{key:"calculate",value:function(){var e=this;this.additional_inputs=[],this.additional_outputs=[];var t,a=null,n=Object(l.a)(this.recipes);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.recipe.outputs.find((function(t){return t.item===e.goal.item}));if(i){var c=f(r.recipe,i,this.goal);r.count=c,a=r.recipe;var u,o=r.recipe.machine.speed/r.recipe.craft_time*c,s=Object(l.a)(r.recipe.inputs);try{for(s.s();!(u=s.n()).done;){var m=u.value;this.additional_inputs.push({amount:m.amount*o,item:m.item})}}catch(k){s.e(k)}finally{s.f()}var p,h=Object(l.a)(r.recipe.outputs.filter((function(t){return t.item!==e.goal.item})));try{for(h.s();!(p=h.n()).done;){var d=p.value;this.additional_outputs.push({amount:d.amount*o,item:d.item})}}catch(k){h.e(k)}finally{h.f()}}else r.count=0}}catch(k){n.e(k)}finally{n.f()}for(var E=!0,y=0;E&&y<1e3;){y++,E=!1;var g,b=Object(l.a)(this.recipes.filter((function(e){return e.recipe!==a})));try{for(b.s();!(g=b.n()).done;){var O=g.value;E=v(this.additional_inputs,this.additional_outputs,O)||E}}catch(k){b.e(k)}finally{b.f()}this.balanceInputAndOutput()}100===y&&console.error("Could not finish calculating the schematic, update_count reached "+y)}},{key:"hasRecipe",value:function(e){return this.recipes.some((function(t){return t.recipe.name===e.name}))}},{key:"balanceInputAndOutput",value:function(){var e,t=this,a=Object(l.a)(this.additional_inputs);try{for(a.s();!(e=a.n()).done;){var n,r=e.value,i=Object(l.a)(this.additional_outputs);try{for(i.s();!(n=i.n()).done;){var c=n.value;if(r.item===c.item){var u=function(e){var a=t.additional_inputs.findIndex((function(t){return t.item===e.item}));t.additional_inputs.splice(a,1)},o=function(e){var a=t.additional_outputs.findIndex((function(t){return t.item===e.item}));t.additional_outputs.splice(a,1)};r.amount===c.amount?(u(r),o(c)):r.amount>c.amount?(r.amount-=c.amount,o(c)):c.amount>r.amount&&(c.amount-=r.amount,u(r))}}}catch(s){i.e(s)}finally{i.f()}}}catch(s){a.e(s)}finally{a.f()}}}]),e}();function f(e,t,a){var n=e.craft_time/e.machine.speed;return a.amount/t.amount*n}function d(e,t){var a,n=Object(l.a)(e);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(r.item===t.item)return void(r.amount+=t.amount)}}catch(i){n.e(i)}finally{n.f()}e.push(t)}function v(e,t,a){var n,r=Object(l.a)(e);try{var i=function(){var r=n.value,i=a.recipe.outputs.find((function(e){return e.item===r.item}));if(null==i)return"continue";c=f(a.recipe,i,r),a.count+=c,u=e.findIndex((function(e){return e.item===r.item})),e.splice(u,1);var o,s=a.recipe.machine.speed/a.recipe.craft_time*c,m=Object(l.a)(a.recipe.outputs.filter((function(e){return e.item!==r.item})));try{for(m.s();!(o=m.n()).done;){var p=o.value;d(t,{item:p.item,amount:p.amount*s})}}catch(y){m.e(y)}finally{m.f()}var h,v=Object(l.a)(a.recipe.inputs);try{for(v.s();!(h=v.n()).done;){var E=h.value;d(e,{item:E.item,amount:E.amount*s})}}catch(y){v.e(y)}finally{v.f()}return{v:!0}};for(r.s();!(n=r.n()).done;){var c,u,o=i();switch(o){case"continue":continue;default:if("object"===typeof o)return o.v}}}catch(s){r.e(s)}finally{r.f()}return!1}var E=a(22),y=a(13),g=a(11),b=a(16),O=a(24),k=function(e){Object(s.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"renderInputOutput",value:function(e){var t=this.props.recipe,a=t.machine,n=this.props.amountOfMachines,i=t.inputs[e],c=t.outputs[e],l=a.speed/t.craft_time*n;return r.a.createElement("tr",{key:e},r.a.createElement("td",null,i?i.item:""),r.a.createElement("td",null,i?(i.amount*l).toFixed(2):""),r.a.createElement("td",null,c?c.item:""),r.a.createElement("td",null,c?(c.amount*l).toFixed(2):""))}},{key:"render",value:function(){var e=this,t=this.props.recipe,a=t.inputs.length>t.outputs.length?t.inputs.length:t.outputs.length;return r.a.createElement(y.a,null,r.a.createElement(y.a.Header,null,r.a.createElement("h3",null,t.name),r.a.createElement("span",{style:{float:"right"}},r.a.createElement("b",null,this.props.amountOfMachines.toFixed(1),"x")," ",t.machine.name)),r.a.createElement(E.a,{striped:!0,bordered:!0,hover:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Input"),r.a.createElement("th",null),r.a.createElement("th",null,"Output"),r.a.createElement("th",null))),r.a.createElement("tbody",null,Array(a).fill(0).map((function(t,a){return e.renderInputOutput(a)})))),r.a.createElement(y.a.Footer,null,r.a.createElement(g.a,{variant:"outline-secondary",disabled:!this.props.canMoveUp,onClick:this.props.onMoveUp},r.a.createElement(O.b,null))," ",r.a.createElement(g.a,{variant:"outline-secondary",disabled:!this.props.canMoveDown,onClick:this.props.onMoveDown},r.a.createElement(O.a,null)),r.a.createElement(g.a,{variant:"danger",style:{float:"right"},onClick:this.props.onDelete},r.a.createElement(b.e,null))))}}]),a}(r.a.Component),_=a(29),C=a(15),j=a(9),S=new(function(){function e(){Object(u.a)(this,e),this.recipes=void 0,this.machines=[{name:"Strand casting machine 4",speed:3},{name:"Blast furnace 4",speed:3},{name:"Induction furnace 4",speed:3},{name:"Pellet press 4",speed:3},{name:"Ore processing machine",speed:3},{name:"Ore sorting facility",speed:2},{name:"Ore refinery",speed:1.5},{name:"Leaching plant",speed:1.5},{name:"Crafting machine",speed:2.75},{name:"Filtration unit",speed:2.25},{name:"Crystallizer",speed:2.25},{name:"Hydro plant",speed:2},{name:"Electrolyser",speed:2.5},{name:"Ore crusher",speed:3},{name:"Washing plant",speed:2.25},{name:"Liquifier",speed:3.75},{name:"Algae farm",speed:1.5},{name:"Custom",speed:1}],this.recipes=[];try{var t=localStorage.getItem("recipes");null!=t&&(this.recipes=JSON.parse(t),console.log("Loaded "+this.recipes.length+" recipes"))}catch(a){}}return Object(o.a)(e,[{key:"save",value:function(){localStorage.setItem("recipes",JSON.stringify(this.recipes))}},{key:"allItems",value:function(){var e,t=[],a=Object(l.a)(this.recipes);try{for(a.s();!(e=a.n()).done;){var n,r=e.value,i=Object(l.a)(r.outputs);try{var c=function(){var e=n.value;if(t.some((function(t){return t===e.item})))return"continue";t.push(e.item)};for(i.s();!(n=i.n()).done;)c()}catch(u){i.e(u)}finally{i.f()}}}catch(u){a.e(u)}finally{a.f()}return t.sort(),t}}]),e}()),R=a(20),I=a(10),w=a(28);function M(e){var t,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={name:e.name,craft_time:e.craft_time,machine:{name:e.machine.name,speed:e.machine.speed},inputs:[],outputs:[]},r=Object(l.a)(e.inputs);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.inputs.push({item:i.item,amount:i.amount})}}catch(s){r.e(s)}finally{r.f()}a&&n.inputs.push({item:"",amount:0});var c,u=Object(l.a)(e.outputs);try{for(u.s();!(c=u.n()).done;){var o=c.value;n.outputs.push({item:o.item,amount:o.amount})}}catch(s){u.e(s)}finally{u.f()}return a&&n.outputs.push({item:"",amount:0}),n}var F=function(e){Object(s.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state=a.getDerivedStateFromProps(e,{recipe:null,craft_time:""}),n}return Object(o.a)(a,[{key:"updateName",value:function(e){if(null!==this.state.recipe){var t=M(this.state.recipe);t.name=e,this.setState({recipe:t})}}},{key:"updateMachine",value:function(e){var t=S.machines.find((function(t){return t.name===e}));if(null!==this.state.recipe&&null!==t){var a=M(this.state.recipe);a.machine=t,this.setState({recipe:a})}}},{key:"updateCraftTime",value:function(e){this.setState({craft_time:e})}},{key:"commitCraftTime",value:function(){try{var e=parseFloat(this.state.craft_time);if(!isNaN(e)&&!Object(w.isNullOrUndefined)(e)){if(null===this.state.recipe)return;var t=M(this.state.recipe);return t.craft_time=e,void this.setState({craft_time:e.toString(),recipe:t})}}catch(n){}var a=this.state.recipe?this.state.recipe.craft_time.toString():"0";this.setState({craft_time:a})}},{key:"render",value:function(){var e=this,t=null!==this.state.recipe,a=this.state.recipe||x;return r.a.createElement(R.a,{show:t,onHide:this.props.onCancel,animation:!1},r.a.createElement(R.a.Header,{closeButton:!0},r.a.createElement(R.a.Title,null,"Edit recipe")),r.a.createElement(R.a.Body,null,r.a.createElement(I.a,null,r.a.createElement(I.a.Group,{as:C.a,controlId:"recipe_name"},r.a.createElement(I.a.Label,{column:!0,sm:"2"},"Name"),r.a.createElement(j.a,{sm:"10"},r.a.createElement(I.a.Control,{value:a.name,onChange:function(t){return e.updateName(t.target.value)}}))),r.a.createElement(I.a.Group,{as:C.a,controlId:"machine"},r.a.createElement(I.a.Label,{column:!0,sm:"2"},"Machine"),r.a.createElement(j.a,{sm:"10"},r.a.createElement(I.a.Control,{as:"select",value:a.machine.name,onChange:function(t){return e.updateMachine(t.target.value)}},S.machines.map((function(e){return r.a.createElement("option",{key:e.name},e.name)}))))),r.a.createElement(I.a.Group,{as:C.a,controlId:"craft_time"},r.a.createElement(I.a.Label,{column:!0,sm:"2"},"Craft time"),r.a.createElement(j.a,{sm:"10"},r.a.createElement(I.a.Control,{value:this.state.craft_time,onChange:function(t){return e.updateCraftTime(t.target.value)},onBlur:function(){return e.commitCraftTime()}}))),r.a.createElement("b",null,"Inputs"),this.renderItemList(a.inputs,(function(e,t){return e.inputs=t})),r.a.createElement("b",null,"Outputs"),this.renderItemList(a.outputs,(function(e,t){return e.outputs=t})))),r.a.createElement(R.a.Footer,null,r.a.createElement(g.a,{variant:"danger",onClick:function(){return e.deleteRecipe()}},r.a.createElement(b.f,null)),r.a.createElement(g.a,{variant:"danger",onClick:this.props.onCancel},"Cancel"),r.a.createElement(g.a,{variant:"primary",onClick:function(){var t=e.state.recipe;null!==t&&(t.inputs=t.inputs.filter((function(e){return""!==e.item&&e.amount>0})),t.outputs=t.outputs.filter((function(e){return""!==e.item&&e.amount>0})),e.props.onSave(t))}},"Save")))}},{key:"renderItemList",value:function(e,t){var a=this;return e.map((function(n,i){return r.a.createElement(I.a.Group,{as:C.a,key:i},r.a.createElement(j.a,{sm:"10"},r.a.createElement(I.a.Control,{value:n.item,onChange:function(n){return function(n,r,i){e[r].item=i,r===e.length-1&&e.push({item:"",amount:0});var c=M(a.state.recipe);t(c,e),a.setState({recipe:c})}(0,i,n.target.value)}})),r.a.createElement(j.a,{sm:"2"},r.a.createElement(I.a.Control,{value:n.amount,onChange:function(n){return function(n,r,i){e[r].amount=parseFloat(i)||e[r].amount,r===e.length-1&&e.push({item:"",amount:0});var c=M(a.state.recipe);t(c,e),a.setState({recipe:c})}(0,i,n.target.value)}})))}))}},{key:"deleteRecipe",value:function(){if(null!==this.state.recipe){var e=this.state.recipe,t=S.recipes.findIndex((function(t){return t.name===e.name}));-1!==t&&(S.recipes.splice(t,1),S.save(),this.props.onCancel())}}}],[{key:"getDerivedStateFromProps",value:function(e,t){return null!==e.recipe&&null===t.recipe?{recipe:M(e.recipe,!0),craft_time:e.recipe.craft_time.toString()}:null===e.recipe?{recipe:null,craft_time:"0"}:t}}]),a}(r.a.Component),x={name:"",machine:S.machines[0],inputs:[],outputs:[],craft_time:1},L=function(e){Object(s.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(u.a)(this,a),n=t.call(this,e);var r=new h({item:"Iron sheet coil",amount:45});return r.calculate(),n.state={schematic:r,editRecipe:null},n}return Object(o.a)(a,[{key:"setGoalItem",value:function(e){var t=this.state.schematic;t.goal.item=e,t.calculate(),this.setState({schematic:t})}},{key:"setGoalAmount",value:function(e){var t=this.state.schematic;t.goal.amount=parseFloat(e)||t.goal.amount,t.calculate(),this.setState({schematic:t})}},{key:"render",value:function(){var e=this,t=this.state.schematic,a=S.recipes.filter((function(e){return!t.hasRecipe(e)})),n=a.filter((function(e){var a,n=Object(l.a)(e.outputs);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(r.item===t.goal.item)return!0;var i,c=Object(l.a)(t.additional_inputs);try{for(c.s();!(i=c.n()).done;){var u=i.value;if(r.item===u.item)return!0}}catch(o){c.e(o)}finally{c.f()}}}catch(o){n.e(o)}finally{n.f()}return!1})),i=a.filter((function(e){return n.every((function(t){return t.name!==e.name}))}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,{fluid:!0},r.a.createElement(C.a,null,r.a.createElement(j.a,null,r.a.createElement("b",null,"Goal: ")," ",r.a.createElement("input",{type:"text",value:this.state.schematic.goal.amount,size:3,onChange:function(t){return e.setGoalAmount(t.target.value)}})," ",r.a.createElement("select",{value:this.state.schematic.goal.item,onChange:function(t){return e.setGoalItem(t.target.value)}},S.allItems().map((function(e){return r.a.createElement("option",{key:e},e)}))),t.recipes.map((function(a,n){return r.a.createElement(k,{key:n,recipe:a.recipe,amountOfMachines:a.count,canMoveUp:n>0,canMoveDown:n<t.recipes.length-1,onDelete:function(){return e.removeRecipe(a.recipe)},onMoveUp:function(){return e.swapRecipes(n-1,n)},onMoveDown:function(){return e.swapRecipes(n,n+1)}})}))),r.a.createElement(j.a,null,r.a.createElement(C.a,null,r.a.createElement(j.a,null,r.a.createElement("h2",null,"Recipes")),r.a.createElement(g.a,{variant:"outline-primary",onClick:function(){return e.newRecipe()}},r.a.createElement(b.c,null))),this.renderAddRecipeSuggestion(),this.renderRecipeList("Suggested",n),this.renderRecipeList("Other",i)),r.a.createElement(j.a,null,r.a.createElement(y.a,null,r.a.createElement(y.a.Header,null,"Additional inputs"),A(t.additional_inputs)),r.a.createElement(y.a,null,r.a.createElement(y.a.Header,null,"Additional outputs"),A(t.additional_outputs)),r.a.createElement(y.a,null,r.a.createElement(y.a.Header,null,"Machines required"),this.renderMachineList())))),r.a.createElement(F,{recipe:this.state.editRecipe,onSave:function(t){return e.saveRecipe(t)},onCancel:function(){return e.resetEditRecipe()}}))}},{key:"renderAddRecipeSuggestion",value:function(){return S.recipes.length>0?null:r.a.createElement(C.a,{className:"alert alert-warning justify-content-between"},"Try adding a recipe",r.a.createElement(b.a,{style:{marginRight:"-0.5em"}}))}},{key:"renderRecipeList",value:function(e,t){var a=this;return 0===t.length?r.a.createElement(r.a.Fragment,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,e),t.map((function(e,t){return a.renderRecipe(e,t)})))}},{key:"renderMachineList",value:function(){return r.a.createElement(E.a,{size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Recipe"),r.a.createElement("th",null,"Machine"),r.a.createElement("th",null,"Amount"))),r.a.createElement("tbody",null,this.state.schematic.recipes.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.recipe.name),r.a.createElement("td",null,e.recipe.machine.name),r.a.createElement("td",null,e.count.toFixed(1)))}))))}},{key:"newRecipe",value:function(){this.setState({editRecipe:x})}},{key:"resetEditRecipe",value:function(){this.state.schematic.calculate(),this.setState({editRecipe:null})}},{key:"saveRecipe",value:function(e){var t=S.recipes.findIndex((function(t){return t.name===e.name}));-1!==t?S.recipes[t]=e:S.recipes.push(e),S.save(),this.resetEditRecipe()}},{key:"swapRecipes",value:function(e,t){var a=this.state.schematic;if(e>=0&&t>=0&&e<a.recipes.length&&t<a.recipes.length){var n=a.recipes[e];a.recipes[e]=a.recipes[t],a.recipes[t]=n,this.setState({schematic:a})}}},{key:"removeRecipe",value:function(e){var t=this.state.schematic,a=t.recipes.findIndex((function(t){return t.recipe.name===e.name}));-1!==a&&(t.recipes.splice(a,1),t.calculate(),this.setState({schematic:t}))}},{key:"renderRecipe",value:function(e,t){var a=this;return r.a.createElement(C.a,{key:t},r.a.createElement(g.a,{variant:"outline-primary",as:j.a,onClick:function(t){t.preventDefault();var n=a.state.schematic;n.add(e),n.calculate(),a.setState({schematic:n})}},r.a.createElement(b.d,null)," ",e.name),r.a.createElement(g.a,{variant:"outline-secondary",onClick:function(){a.setState({editRecipe:e})}},r.a.createElement(b.b,null)))}}]),a}(r.a.Component);function A(e){return r.a.createElement(E.a,{size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Item"),r.a.createElement("th",null,"Amount"))),r.a.createElement("tbody",null,e.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.item),r.a.createElement("td",null,e.amount.toFixed(2)))}))))}var D=function(){return r.a.createElement(L,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.30848667.chunk.js.map